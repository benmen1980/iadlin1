<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">

    <title>אתר חיפוש מזוודות</title>
</head>
<body dir="rtl">
<div class="container">
    <div class="row">
    </div>
        <br>
        <h1>א.ר.י שירותים לתעופה ולוגיסטיקה בע"מ - פורטל לקוחות</h1>

    </div>
</div>
<div class="container span2 ">
    <div class="row">
        <div class="col-sm">

        </div>
        <div class="col-sm ">




            <form>
                <div class="form-group ">
                    <label class="float-right" for="booknum">מספר השובר</label>
                    <div class="input-group">
                    <input  type="text" class="form-control" id="booknum" aria-describedby="emailHelp" placeholder="ELAL123456" value="LY55972"/>
                    <span class="input-group-addon"></span>
                    <input  type="text" class="form-control" id="docno" aria-describedby="emailHelp" placeholder="" value="" readonly/>
                    </div>
                    <small  class="form-text text-muted float-right">מספר השובר מופיע על הטופס שמילאת בשדה התעופה</small>

                </div>
                <br>
                <div class="form-group span2">
                    <label class="float-right" for="cellphone">מספר טלפון נייד</label>
                    <input type="text" class="form-control" id="cellphone" placeholder="0501234567" value="0523782066">
                </div>


            </form>

            <button  class="btn btn-primary float-right span6" onclick="getfrompriorityerp()">חפש התאמה</button>




        </div>
        <div class="col-sm">

        </div>
    </div>
</div>

<div class="container span2 ">
    <div class="row">
        <div class="col-sm">

        </div>
        <div id="error-message" class="col-sm d-none">
            <br>
            <p  class="text-right" dir="rtl">נוסע נכבד, לא נמצאה התאמה בין קוד השובר והנייד הנמצא במערכת, אנא נסה שנית (טלפון ללא תוים) או פנה לחברת
    התעופה                                      </p>
        </div>
        <div class="col-sm">

        </div>
    </div>
</div>
<!-- container for response -->
<div id="responseform" class="container  d-none"><div class="row ">
    <div class="col-sm">

    </div>
    <div class="col-sm">
        <form>
            <div class="form-group ">
                <label class="float-right" >שם נוסע</label>
                <input id="CDES"  type="text" class="form-control"  aria-describedby="emailHelp" placeholder="">
            </div>
            <br>
            <div class="form-group ">
                <label class="float-right" >כתובת</label>
                <input  id="ELIT_FULLADDRESS" type="text" class="form-control"  aria-describedby="emailHelp" placeholder="">
            </div>
            <br>
            <div class="form-group ">
                <label class="float-right" >עיר</label>
                <input id="ELIT_CITYNAME" type="text" class="form-control"  aria-describedby="emailHelp" placeholder="">
                <small id="emailHelp" class="form-text text-muted float-right">באפשרותך לעדכן נתוני נוסע</small>
            </div>
            <br>
            <div class="form-group ">
                <label class="float-right" >סטאטוס תעודת משלוח</label>
                <input id="STATDES" type="text" readonly class="form-control"  aria-describedby="emailHelp" placeholder="">
            </div>
            <br>
            <div class="form-group ">
                <label class="float-right" >הערה למשלוח</label>
                <textarea maxlength="48" id="comment" type="text"  class="form-control"  aria-describedby="emailHelp" placeholder=""></textarea>
            </div>
            <br>
        </form>
        <button  id="update-data" class="btn btn-primary float-right span6" onclick="updatePriority()">עדכן נתוני נוסע</button>
    </div>
    <div class="col-sm">
    </div>
</div></div>

<div class="container span2 ">
    <div class="row">
        <div class="col-sm">

        </div>
        <div id="dialog-message" class="col-sm d-none">
            <br>
            <p  class="text-right" dir="rtl">הנתונים התעדכנו בהצלחה.</p>
        </div>
        <div class="col-sm">

        </div>
    </div>
</div>
<!--table id="table">
    <thead>
    <tr>
        <th data-field="PARTNAME">Item ID</th>
        <th data-field="PARTDES">Item Name</th>
        <th data-field="UNIT">Item Price</th>
    </tr>
    </thead>
</table-->



<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/js/bootstrap.min.js" integrity="sha384-o+RDsa0aLu++PJvFqy8fFScvbHFLtbvScb8AjopnFD+iEQ7wo/CG0xlczd+2O/em" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.12.1/bootstrap-table.js"></script>
<script>

    function getfrompriorityerp() {
        resetforms();
        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var response = JSON.parse(this.responseText);
                if(!response[0]){
                    document.getElementById("error-message").classList.remove("d-none");
                }else {
                    document.getElementById("responseform").classList.remove("d-none");
                    var cdes = response[0]["CDES"]
                    var fulladdress = response[0]["ELIT_FULLADDRESS"]
                    var cityname = response[0]["ELIT_CITYNAME"]
                    var statusdes = response[0]["STATDES"]
                    var docno = response[0]["DOCNO"]
                    document.getElementById("CDES").value = cdes;
                    document.getElementById("ELIT_FULLADDRESS").value = fulladdress;
                    document.getElementById("ELIT_CITYNAME").value = cityname;
                    document.getElementById("STATDES").value = statusdes;
                    document.getElementById("docno").value = docno;
                }

            }
        };
        booknum = document.getElementById("booknum").value;
        cellphone = document.getElementById("cellphone").value;

        xmlhttp.open("GET","include/GetData.php?booknum="+booknum+"&cellphone="+cellphone,true);
        xmlhttp.send();


    }


    function updatePriority() {

        if (window.XMLHttpRequest) {
            // code for IE7+, Firefox, Chrome, Opera, Safari
            xmlhttp = new XMLHttpRequest();
        } else {
            // code for IE6, IE5
            xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xmlhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                var response = JSON.parse(this.responseText);
                if(!response[0]){
                    document.getElementById("dialog-message").classList.remove("d-none");
                    document.getElementById("update-data").classList.add("d-none");
                    document.getElementById("responseform").classList.add("d-none");



                }else {
                    // add warning after internal failure
                }

            }else{
                // error on ajax
            }
        };
        docno = document.getElementById("docno").value;
        cdes = document.getElementById("CDES").value;
        address = document.getElementById("ELIT_FULLADDRESS").value;
        city = document.getElementById("ELIT_CITYNAME").value;
        comment = document.getElementById("comment").value;

        xmlhttp.open("GET","include/updatePriority.php?cdes="+cdes+"&address="+address+"&city="+city+"&comment="+ comment+ "&docno="+ docno,true);
        xmlhttp.send();


    }


function resetforms(){
    document.getElementById("CDES").value = "";
    document.getElementById("ELIT_FULLADDRESS").value = "";
    document.getElementById("ELIT_CITYNAME").value = "";
    document.getElementById("STATDES").value = "";
    document.getElementById("comment").value = "";
    document.getElementById("docno").value = "";
    document.getElementById("error-message").classList.add("d-none");
    document.getElementById("responseform").classList.add("d-none");
    document.getElementById("dialog-message").classList.add("d-none");
    document.getElementById("update-data").classList.remove("d-none");


}
</script>


</body>
</html>